<html> <head>  <script>   function Cookie(document, name, hours, path, domain, secure)   {    this.$document = document;    this.$name = name;    if (hours)     this.$expiration = new Date((new Date()).getTime() + hours * 3600000);    else     this.$expiration = null;    if (path)     this.$path = path;    else     this.$path = null;    if (domain)     this.$domain = domain;    else     this.$domain = null;    if (secure)     this.$secure = true;    else     this.$secure = false;   }   Cookie.prototype.store = function() {    var cookieval = "";    for (var prop in this) {     if ((prop.charAt(0) == '$') || ((typeof this[prop]) == 'function'))      continue;     if (cookieval != "")      cookieval += '&';     cookieval += prop + ':' + escape(this[prop]);    }    var cookie = this.$name + '=' + cookieval;    if (this.$expiration)     cookie += '; expires=' + this.$expiration.toGMTString();    if (this.$path)     cookie += '; path=' + this.$path;    if (this.$domain)     cookie += '; domain=' + this.$domain;    if (this.$secure)     cookie += '; secure';    this.$document.cookie = cookie;   }   Cookie.prototype.load = function() {    var allcookies = this.$document.cookie;    if (allcookies == "")     return false;    var start = allcookies.indexOf(this.$name + '=');    if (start == -1)     return false;    start += this.$name.length + 1;    var end = allcookies.indexOf(';', start);    if (end == -1)     end = allcookies.length;    var cookieval = allcookies.substring(start, end);    var a = cookieval.split('&');    for (var i = 0; i < a.length; i++)     a[i] = a[i].split(':');    for (var i = 0; i < a.length; i++) {     this[a[i][0]] = unescape(a[i][1]);    }    return true;   }   Cookie.prototype.remove = function() {    var cookie;    cookie = this.$name + '=';    if (this.$path)     cookie += '; path=' + this.$path;    if (this.$domain)     cookie += '; domain=' + this.$domain;    cookie += '; expires=Fri, 02-Jan-1970 00:00:00 GMT';    this.$document.cookie = cookie;   }   var pSettings = new Object();   var IS_EXE = is_exe();   var ACTIVATED = is_activated();   var w_main_page = "";   var FROM_LEGAL = false;   var settings;   //deleteProgramSettings();   function programInit()   {    //    // load saved program settings    //    loadProgramSettings();    //    // legal    //    var ok = getProgramSetting('tc');    if (ok) {     w_main_page = 'main.html';    } else {     w_main_page = 'legal.html';     //deleteProgramSettings();    }    //alert("ok:"+ok+" "+w_main_page);   }   function is_exe()   {    var exe = '[={nowyear}]';    var test = '[' + '={' + 'nowyear}]';    if (exe == test) {     //alert(exe);     return false;    }    //alert(EXE);    return true;   }   function refreshforActivation(s) {    if (s) {     location.reload();    }   }   function is_activated() {    return settings.isActivated();   }   function loadProgramSettings() {    settings.loadProgramSettings();   }   function getProgramSetting(s) {    return settings.getProgrammSettings(s);   }   // always call storeProgramSettings() after setting vars   function callDefaultBrowser(url) {    settings.callDefaultBrowser(url);   }   function setProgramSetting(s, v) {    settings.setProgramSettings(s, v);   }   function storeProgramSettings() {    settings.storeProgramSettings();   }   function sendMessage(s) {    settings.writeMessage(s);   }   function showActivationDialog() {    settings.showActivationDialog();   }   function showConfigDialog(id){    settings.showConfigDialog(id);   }   function showDateFormatDialog(){    settings.showDateFormatDialog();   }   function printWebView(str, type){    settings.printWebView(str, type);   }      function exportCSV(str){    settings.exportCSV(str);   }   function addOptions(tzh, tzd){    settings.addOptions(tzh, tzd);   }   function newHandleSetDateTime(d_str, t_str){    document.getElementById("iframe_main").contentWindow.newHandleSetDateTime(d_str, t_str);    }      function showColumnChooserDialog(){    settings.showColumnChooserDialog();   }     function findData(){    settings.showFindData();   }   function setFindData(number, month, day, name, date){        document.getElementById("iframe_main").contentWindow.generateTable(number, month, day, name, date);      }   function setInterval(columns, dateFormat, timeFormat, timOfDay, date, numberOfDays, interval){    document.getElementById("iframe_main").contentWindow.generateTableWithInterval(getProgramSetting("date"), getProgramSetting("time"),columns, dateFormat, timeFormat, timOfDay, date, numberOfDays, interval);   }   function newSetLoc(){    document.getElementById("iframe_main").contentWindow.newSetLoc();   }   function restartRefresh(){        document.getElementById("iframe_main").contentWindow.startRefresh();   }   function continueRefresh(){    document.getElementById("iframe_main").contentWindow.continueRefresh();       }   function getHeight(){    return settings.getHeight();   }   function deleteProgramSettings()   {    if (IS_EXE) {     window.external.ActivSet('pSettingsStr', "");    } else {     var ps_temp = new Cookie(document, "program_settings", 240);     ps_temp.remove();     ps_temp.load();    }   }   function debug_getProgramSettingsStr()   {    //var ps = new Cookie(document,"program_settings",240);    //ps.load();    ps = top.pSettings;    var str = "";    str += "TZ: " + ps.tz;    //str += "\nLt: "+ps.Lt;    str += "\nLt_d: " + ps.Lt_d;    str += "\nLt_m: " + ps.Lt_m;    str += "\nLt_s: " + ps.Lt_s;    str += "\nLt_dir: " + ps.Lt_dir;    //str += "\nLg: "+ps.Lg;    str += "\nLg_d: " + ps.Lg_d;    str += "\nLg_m: " + ps.Lg_m;    str += "\nLg_s: " + ps.Lg_s;    str += "\nLg_dir: " + ps.Lg_dir;    str += "\njdate: " + ps.jd;    str += "\ndt_format: " + ps.dt_format;    str += "\nclock: " + ps.clock;    str += "\ncal_time: " + ps.cal_time;    str += "\nrefresh: " + ps.refresh;    str += "\nDate: " + dtStr2(ps.jd, ps.dt_format) + " " + tStr2(ps.jd, ps.clock, 1);    str += "\ncV: " + ps.cV;    return str;   }   //   // init vars   //   programInit();  </script> </head> <script language="JavaScript" type="text/javascript">  document.write('<frameset name="program_frameset" rows="100%,*" framespacing="0" frameborder="0" marginwidth="0" marginheight="0" border="0">');  //alert('<frame src="' + w_main_page + '" name="main" scrollbars="no" scrolling="no" framespacing="0" frameborder="no" border="0" noresize="1">');  document.write('<frame id = "iframe_main" src="' + w_main_page + '" name="main" scrollbars="no" scrolling="no" framespacing="0" frameborder="no" border="0" noresize="1">');  document.write('<frame src="blank.html" name="heading" scrollbars="no" scrolling="no" framespacing="0" frameborder="no" border=0 style="border-bottom: 1px solid #ffffff" noresize="1">');                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        document.write('</frameset>'); </script></html>